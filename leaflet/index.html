<html>
<head>
    <title>Leaflet Map Example</title>

    <!-- Include css files and a favicon icon -->
    <link rel="stylesheet" href="css/leaflet.css" />
    <link rel="stylesheet" href="css/style1.css"/>
    <link rel="stylesheet" href="css/leaflet.zoomhome.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/L.Control.MousePosition.css"/>
    
    <!-- Include javascript files -->
    <script src="javascript/leaflet.js"></script>
    <script src="javascript/papaparse.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    
    <script src="javascript/leaflet.zoomhome.min.js"></script>
    <script src="javascript/L.Control.MousePosition.js"></script>
    <!--<script src="javascript/leaflet-color-markers.js"></script> -->

</head>

<header>
    <h1>Leaflet Map Example</h1>
</header>

<body>
    <div id="mapid"></div>

        <script>

            // turn asynchronous mode off
            $.ajaxSetup({
                async: false
            });

            // Basemap Layers
            // To get the URL from studio.mapbox.com:
            // After publishing, look under the 'Use' tag and select 'Third Party'
            // Use the integration URL from the 'CARTO' option

            var topographic = L.tileLayer('https://api.mapbox.com/styles/v1/masforce/cjs108qje09ld1fo68vh7t1he/tiles/256/{z}/{x}/{y}@2x?access_token=pk.eyJ1IjoibWFzZm9yY2UiLCJhIjoiY2pzMTA0bmR5MXAwdDN5bnIwOHN4djBncCJ9.ZH4CfPR8Q41H7zSpff803g', {
                attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
                id: 'firstMap'
            }),
            simple = L.tileLayer('https://api.mapbox.com/styles/v1/masforce/cjs13btye0cgx1fqlkv8z7ek9/tiles/256/{z}/{x}/{y}@2x?access_token=pk.eyJ1IjoibWFzZm9yY2UiLCJhIjoiY2pzMTA0bmR5MXAwdDN5bnIwOHN4djBncCJ9.ZH4CfPR8Q41H7zSpff803g', {
                attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
                id: 'firstMap'
            });

            // Create a Leaflet Map. Center on Fort Collins and set zoom level to 12
            // Set the default layers that appear on initialization
            var mymap = L.map('mapid', {
                center: [40.576530, -105.080772],
                zoom: 12,
                layers: [simple, topographic],
                zoomControl: false
            });


            var baseMaps = {
                "Simple": simple,
                "Topographical": topographic
            };

            /* Add layers to the map */
            L.control.layers(baseMaps).addTo(mymap);







               /* Get Boundary data */
           var Water_Provider = (function() {
                    var result;
                    $.getJSON("data-files/Colorado-Dairies.geojson",function(data) {
                        result = data;
                    }); return result;
            })();

            var provider = L.geoJson(Water_Provider, {
                onEachFeature: onEachFeature
            }).addTo(mymap);












            
            var zoomHome = L.Control.zoomHome();
            zoomHome.addTo(mymap);

            L.control.mousePosition({position: 'bottomleft',lngFormatter: function(num) {
                var direction = (num < 0) ? 'W' : 'E';
                var formatted = Math.abs(L.Util.formatNum(num, 6)) + '&deg ' + direction;
                return formatted; 
            },
            latFormatter: function(num) {
                var direction = (num < 0) ? 'S' : 'N';
                var formatted = Math.abs(L.Util.formatNum(num, 6)) + '&deg ' + direction;
                return formatted;
            }}).addTo(mymap);

             /* Bottom Right corner. This shows the scale in km and miles of
            the map. */
            L.control.scale({position: 'bottomleft',imperial: true}).addTo(mymap);


           

            //function whenClicked(e) {
            //    var layer = e.target;
            //    console.log(layer.feature.properties.DairyName)
            //    layer.bindPopup(layer.feature.properties.DairyName).openPopup();
            //}

            function onEachFeature(feature, l) {
                //l.bindPopup('<pre>'+JSON.stringify(f.properties,null,' ').replace(/[\{\}"]/g,'')+'</pre>');

                var popupContent = '<table style="border-style: solid;">';
                for (var p in feature.properties) {
                    popupContent += '<tr><td style="border-style: solid;">' + p + '</td><td>'+ feature.properties[p] + '</td></tr>';
                }
                popupContent += '</table>';

                var myPopup = L.popup({maxHeight: 200, maxWidth: 600}).setContent(popupContent);

                l.bindPopup(myPopup);
            }


            //Next: try add table styles to the style sheet to make it look nicer


        </script>
</body>
